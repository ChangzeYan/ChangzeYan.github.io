<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"changzeyan.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
<meta property="og:type" content="website">
<meta property="og:title" content="YCZ">
<meta property="og:url" content="https://changzeyan.github.io/page/2/index.html">
<meta property="og:site_name" content="YCZ">
<meta property="og:description" content="天空中没有留下翅膀的痕迹，但我已飞过">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ChangzeYan">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://changzeyan.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>YCZ</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="YCZ" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">YCZ</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">走向内心，寻求超越</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/03/13/write/origin/origin/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/13/write/origin/origin/" class="post-title-link" itemprop="url">origin</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-13 15:53:11" itemprop="dateCreated datePublished" datetime="2021-03-13T15:53:11+08:00">2021-03-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-23 19:55:03" itemprop="dateModified" datetime="2021-05-23T19:55:03+08:00">2021-05-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Origin/" itemprop="url" rel="index"><span itemprop="name">Origin</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="倾斜横坐标"><a href="#倾斜横坐标" class="headerlink" title="倾斜横坐标"></a>倾斜横坐标</h1><p>双击横坐标下的文字，或者右键选择横坐标，然后点击刻度线标签</p>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/origin-scale1.png" alt="双击横坐标"></p>
<p>然后接着点击刻度线标签下的格式，设置旋转角度：</p>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/origin-scale2.png" alt="双击横坐标"></p>
<h1 id="根据某两列计算第三列数"><a href="#根据某两列计算第三列数" class="headerlink" title="根据某两列计算第三列数"></a>根据某两列计算第三列数</h1><p>参考：<a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/286467057.html">origin 8.0两列相加怎么算</a></p>
<p>全选要生成的列，右键，set colum values。</p>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/calculate_cols.png" alt="在选项卡中选择参与计算的列"></p>
<h1 id="去掉导出图片的白边"><a href="#去掉导出图片的白边" class="headerlink" title="去掉导出图片的白边"></a>去掉导出图片的白边</h1><p>右键图片，选择 Fit page to layers，根据需要调整border值。</p>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/origin_fit_page_to_layers.png" alt="在选项卡中选择参与计算的列"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/03/11/write/latex/latex-lst/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/11/write/latex/latex-lst/" class="post-title-link" itemprop="url">代码和算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-11 21:21:26" itemprop="dateCreated datePublished" datetime="2021-03-11T21:21:26+08:00">2021-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-22 10:30:18" itemprop="dateModified" datetime="2021-05-22T10:30:18+08:00">2021-05-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Latex/" itemprop="url" rel="index"><span itemprop="name">Latex</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="定制lstlisting-的标题"><a href="#定制lstlisting-的标题" class="headerlink" title="定制lstlisting 的标题"></a>定制lstlisting 的标题</h1><p>参考：<a target="_blank" rel="noopener" href="https://www.latexstudio.net/archives/625.html">按照算法标题样式定制listings的标题</a></p>
<pre><code>\renewcommand*\thelstnumber&#123;\arabic&#123;lstnumber&#125;:&#125;

\DeclareCaptionFormat&#123;mylst&#125;&#123;\hrule#1#2#3&#125;
\captionsetup[lstlisting]&#123;format=mylst,labelfont=bf,singlelinecheck=off,labelsep=space&#125;


\documentclass&#123;article&#125;
\usepackage&#123;listings&#125;
\usepackage&#123;caption&#125;

\lstset&#123;
language=C++,
basicstyle=\small\ttfamily,
numbers=left,
numbersep=5pt,
xleftmargin=20pt,
showstringspaces=false, %去掉空格时产生的下划的空格标志, 设置为true则出现
frame=tb,
framexleftmargin=20pt
&#125;

\renewcommand*\thelstnumber&#123;\arabic&#123;lstnumber&#125;:&#125;

\DeclareCaptionFormat&#123;mylst&#125;&#123;\hrule#1#2#3&#125;
\captionsetup[lstlisting]&#123;format=mylst,labelfont=bf,singlelinecheck=off,labelsep=space&#125;

\begin&#123;document&#125;

\begin&#123;lstlisting&#125;[caption=&#123;test algorithm&#125;,label=&#123;lst1&#125;]
#include
using namespace std;

int main()
&#123;
cout &lt;&lt; &quot;Welcome to the wonderful world of C++!!!\n&quot;;
return 0;
&#125;
\end&#123;lstlisting&#125;

\end&#123;document&#125;
</code></pre>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/latex-lst.png" alt="hithesis生成的样式-本部硕士中期"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/03/09/python/nlp/keras/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/09/python/nlp/keras/" class="post-title-link" itemprop="url">Keras</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-03-09 19:27:36" itemprop="dateCreated datePublished" datetime="2021-03-09T19:27:36+08:00">2021-03-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-13 15:35:37" itemprop="dateModified" datetime="2021-04-13T15:35:37+08:00">2021-04-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Keras-和-Tensorflow的版本对应关系"><a href="#Keras-和-Tensorflow的版本对应关系" class="headerlink" title="Keras 和 Tensorflow的版本对应关系"></a>Keras 和 Tensorflow的版本对应关系</h2><pre><code>tensorflow 2.0 - keras 2.2.4
tensorflow 1.9 - keras 2.2.0 对应keras-transformer==0.31.0
tensorflow 1.8 - keras 2.1.6
tensorflow 1.5 - keras 2.1.4 
tensorflow 1.4 - keras 2.1.3
tensorflow 1.3 - keras 2.1.2
tensorflow 1.2 - keras 2.1.1

TensorFlow 1.14.0 + Keras 2.2.5 on Python 3.6.
TensorFlow 1.13.0 + Keras 2.2.4 on Python 3.6.
TensorFlow 1.12.0 + Keras 2.2.4 on Python 3.6.
TensorFlow 1.11.0 + Keras 2.2.4 on Python 3.6.
TensorFlow 1.10.0 + Keras 2.2.0 on Python 3.6.
TensorFlow 1.12.0 + Keras 2.2.4 on Python 2.
TensorFlow 1.11.0 + Keras 2.2.4 on Python 2.
</code></pre>
<h2 id="保存和加载模型"><a href="#保存和加载模型" class="headerlink" title="保存和加载模型"></a>保存和加载模型</h2><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/tszupup/article/details/85198949">Keras框架下的保存模型和加载模型</a></p>
<ol>
<li>完整保存使用model.save()完整地保存整个模型，将Keras模型和权重保存在一个HDF5文件中，该文件将包含：模型的结构，模型的参数以及优化器参数：用于继续训练过程</li>
</ol>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>core <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Activation
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>optimizers <span class="token keyword">import</span> SGD
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> np_utils
<span class="token comment" spellcheck="true">#随机数种子，重复性设置</span>
np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1671</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#网络结构和训练的参数</span>
NB_EPOCH <span class="token operator">=</span> <span class="token number">20</span>
BATCH_SIZE <span class="token operator">=</span> <span class="token number">128</span>
VERBOSE <span class="token operator">=</span> <span class="token number">1</span>
NB_CLASSES <span class="token operator">=</span> <span class="token number">10</span>
OPTIMIZER <span class="token operator">=</span> SGD<span class="token punctuation">(</span><span class="token punctuation">)</span>
N_HIDDEN <span class="token operator">=</span> <span class="token number">128</span>
VALIDATION_SPLIT <span class="token operator">=</span> <span class="token number">0.2</span>
RESHAPED <span class="token operator">=</span> <span class="token number">784</span>
<span class="token comment" spellcheck="true">#加载数据</span>
<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span>path<span class="token operator">=</span><span class="token string">"mnist.npz"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    f <span class="token operator">=</span> np<span class="token punctuation">.</span>load<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    x_train<span class="token punctuation">,</span> y_train <span class="token operator">=</span> f<span class="token punctuation">[</span><span class="token string">'x_train'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span><span class="token string">'y_train'</span><span class="token punctuation">]</span>
    x_test<span class="token punctuation">,</span> y_test <span class="token operator">=</span> f<span class="token punctuation">[</span><span class="token string">'x_test'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> f<span class="token punctuation">[</span><span class="token string">'y_test'</span><span class="token punctuation">]</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>
 
<span class="token comment" spellcheck="true">#调用函数加载数据</span>
<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#数据预处理</span>
<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#数据变形、类型转换及归一化</span>
x_train <span class="token operator">=</span> x_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">60000</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>
x_test <span class="token operator">=</span> x_test<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>
<span class="token comment" spellcheck="true">#打印消息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Training samples:'</span><span class="token punctuation">,</span> x_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Testing samples:'</span><span class="token punctuation">,</span> x_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#将类别转换为one-hot编码</span>
y_train <span class="token operator">=</span> np_utils<span class="token punctuation">.</span>to_categorical<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> NB_CLASSES<span class="token punctuation">)</span>
y_test <span class="token operator">=</span> np_utils<span class="token punctuation">.</span>to_categorical<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> NB_CLASSES<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#定义网络结构</span>
model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>N_HIDDEN<span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span>RESHAPED<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>N_HIDDEN<span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>NB_CLASSES<span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#打印模型概述信息</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token comment" spellcheck="true">#编译模型</span>
model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> optimizer<span class="token operator">=</span>OPTIMIZER<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#训练模型</span>
history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>BATCH_SIZE<span class="token punctuation">,</span> epochs<span class="token operator">=</span>NB_EPOCH<span class="token punctuation">,</span> verbose<span class="token operator">=</span>VERBOSE<span class="token punctuation">,</span>
                    validation_split<span class="token operator">=</span>VALIDATION_SPLIT<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#评估模型</span>
score <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> verbose<span class="token operator">=</span>VERBOSE<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Test score:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Test accuracy:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 保存模型</span>
model<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'my_model.h5'</span><span class="token punctuation">)</span>
</code></pre>
<p>加载：</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> load_model

<span class="token comment" spellcheck="true">#加载整个模型</span>
model <span class="token operator">=</span> load_model<span class="token punctuation">(</span><span class="token string">'my_model.h5'</span><span class="token punctuation">)</span>
 
<span class="token comment" spellcheck="true">#训练模型</span>
history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>BATCH_SIZE<span class="token punctuation">,</span> epochs<span class="token operator">=</span>NB_EPOCH<span class="token punctuation">,</span> verbose<span class="token operator">=</span>VERBOSE<span class="token punctuation">,</span>
                    validation_split<span class="token operator">=</span>VALIDATION_SPLIT<span class="token punctuation">)</span>
 
<span class="token comment" spellcheck="true">#评估模型</span>
score <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> verbose<span class="token operator">=</span>VERBOSE<span class="token punctuation">)</span>
</code></pre>
<ol start="2">
<li>保存模型结构和权重<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Sequential
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>core <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Activation
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>optimizers <span class="token keyword">import</span> SGD
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> np_utils
<span class="token comment" spellcheck="true"># 定义网络结构</span>
model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>N_HIDDEN<span class="token punctuation">,</span> input_shape<span class="token operator">=</span><span class="token punctuation">(</span>RESHAPED<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>N_HIDDEN<span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">'relu'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>NB_CLASSES<span class="token punctuation">)</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Activation<span class="token punctuation">(</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 打印模型概述信息</span>
model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 编译模型</span>
model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span> optimizer<span class="token operator">=</span>OPTIMIZER<span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 训练模型</span>
history <span class="token operator">=</span> model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span>BATCH_SIZE<span class="token punctuation">,</span> epochs<span class="token operator">=</span>NB_EPOCH<span class="token punctuation">,</span> verbose<span class="token operator">=</span>VERBOSE<span class="token punctuation">,</span>
                 validation_split<span class="token operator">=</span>VALIDATION_SPLIT<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 评估模型</span>
score <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">,</span> verbose<span class="token operator">=</span>VERBOSE<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Test score:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Test accuracy:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 保存模型的结构</span>
json_string <span class="token operator">=</span> model<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 方式1</span>
open<span class="token punctuation">(</span><span class="token string">'model_architecture_1.json'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>json_string<span class="token punctuation">)</span>
yaml_string <span class="token operator">=</span> model<span class="token punctuation">.</span>to_yaml<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 方式2</span>
open<span class="token punctuation">(</span><span class="token string">'model_arthitecture_2.yaml'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>yaml_string<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 保存模型的权重</span>
model<span class="token punctuation">.</span>save_weights<span class="token punctuation">(</span><span class="token string">'my_model_weights.h5'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 打印消息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'训练和保存模型结构完成！！！'</span><span class="token punctuation">)</span>
</code></pre>
</li>
</ol>
<p>加载结构：</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> model_from_json
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> model_from_yaml
<span class="token comment" spellcheck="true"># 加载模型结构</span>
model <span class="token operator">=</span> model_from_json<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'model_architecture_1.json'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
或：
model <span class="token operator">=</span> model_from_yaml<span class="token punctuation">(</span>open<span class="token punctuation">(</span><span class="token string">'model_arthitecture_2.yaml'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 加载模型权重</span>
model<span class="token punctuation">.</span>load_weights<span class="token punctuation">(</span><span class="token string">'my_model_weights.h5'</span><span class="token punctuation">)</span>
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/02/10/python/python-yu-fa/pip/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/10/python/python-yu-fa/pip/" class="post-title-link" itemprop="url">Pip</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-10 10:32:04 / 修改时间：10:57:33" itemprop="dateCreated datePublished" datetime="2021-02-10T10:32:04+08:00">2021-02-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="查看pip-安装了那些包"><a href="#查看pip-安装了那些包" class="headerlink" title="查看pip 安装了那些包"></a>查看pip 安装了那些包</h2><pre class=" language-bash"><code class="language-bash">查看所有
pip list

查看是否安装了某个包
centos
pip list<span class="token operator">|</span><span class="token function">grep</span> pandas

windows
pip list <span class="token operator">|</span> findstr pandas
</code></pre>
<h2 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h2><pre class=" language-bash"><code class="language-bash">4.查看已安装过的包
pip show - -files Somepackage
5.检查哪些包需要更新
pip list - -outdated
</code></pre>
<h2 id="升级"><a href="#升级" class="headerlink" title="升级"></a>升级</h2><pre class=" language-bash"><code class="language-bash">6.升级包
pip <span class="token function">install</span> --upgrade Somepackage

升级pip：
python -m pip <span class="token function">install</span> --upgrade pip
或者：pip <span class="token function">install</span> -U pip
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/02/10/python/nlp/shi-ti-shi-bie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/10/python/nlp/shi-ti-shi-bie/" class="post-title-link" itemprop="url">实体识别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-10 09:59:13" itemprop="dateCreated datePublished" datetime="2021-02-10T09:59:13+08:00">2021-02-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-18 19:59:42" itemprop="dateModified" datetime="2021-06-18T19:59:42+08:00">2021-06-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="实体识别工具"><a href="#实体识别工具" class="headerlink" title="实体识别工具"></a>实体识别工具</h1><h2 id="Pyhanlp"><a href="#Pyhanlp" class="headerlink" title="Pyhanlp"></a><a target="_blank" rel="noopener" href="https://github.com/hankcs/pyhanlp">Pyhanlp</a></h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>先安装JDK。你需要保证JDK位数、操作系统位数和Python位数一致。然后设置JAVA_HOME环境变量，最后执行：</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># (可选)conda安装jpype1更方便</span>
conda <span class="token function">install</span> -c conda-forge jpype1<span class="token operator">==</span>0.7.0      
pip <span class="token function">install</span> pyhanlp
</code></pre>
<p>检测是否安装成功：</p>
<pre class=" language-bash"><code class="language-bash">hanlp
</code></pre>
<p>如果安装成功，会自动下载词典</p>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/hanlp-install-success.png" alt="安装成功"></p>
<p>如果报RuntimeError: module compiled against API version 0xc but this version of numpy is 0xb，需要升级 numpy：</p>
<pre class=" language-bash"><code class="language-bash">pip <span class="token function">install</span> --upgrade numpy
</code></pre>
<h3 id="交互模式"><a href="#交互模式" class="headerlink" title="交互模式"></a>交互模式</h3><pre class=" language-bash"><code class="language-bash">hanlp segment
</code></pre>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/hanlp-segment.png" alt="交互模式"></p>
<h3 id="hanlp词性表"><a href="#hanlp词性表" class="headerlink" title="hanlp词性表"></a>hanlp词性表</h3><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u014258362/article/details/81044286">hanlp词性表</a></p>
<h2 id="StanfordCoreNLP"><a href="#StanfordCoreNLP" class="headerlink" title="StanfordCoreNLP"></a>StanfordCoreNLP</h2><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><pre class=" language-bash"><code class="language-bash"> pip <span class="token function">install</span> stanfordcorenlp 
</code></pre>
<p>由于其源码为 JAVA 编写，所以需要 JDK1.8 及以上版本的支持，下载安装 JDK1.8。<br>下载 <a target="_blank" rel="noopener" href="https://stanfordnlp.github.io/CoreNLP/">StanfordCoreNLP 的相关文件</a>，解压到任意目录</p>
<p>如果要处理中文，还需下载中文jar包：<a target="_blank" rel="noopener" href="http://nlp.stanford.edu/software/stanford-chinese-corenlp-2018-10-05-models.jar">stanford-chinese-corenlp-2018-10-05-models</a>，下载完放到上一步解压后的文件夹中。</p>
<h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> stanfordcorenlp <span class="token keyword">import</span> StanfordCoreNLP
 
<span class="token comment" spellcheck="true"># 加载模型，路径是上面解压的路径</span>
stanford_model <span class="token operator">=</span> StanfordCoreNLP<span class="token punctuation">(</span>r<span class="token string">'./stanford-corenlp-full-2018-02-27'</span><span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">'zh'</span><span class="token punctuation">)</span>
 
text <span class="token operator">=</span> <span class="token string">"张三和李四在2019年3月23日在北京的腾讯技术有限公司一起开会。"</span>
 
res <span class="token operator">=</span> stanford_model<span class="token punctuation">.</span>ner<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
</code></pre>
<p>参数：<br>处理英文时：lang=’en’</p>
<h2 id="kashgari"><a href="#kashgari" class="headerlink" title="kashgari"></a>kashgari</h2><p>参考：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27492735/article/details/108767237">Kashgari:一个方便快捷的命名实体识别、文本分类工具包</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mingriyingying/p/13379434.html">NER-使用kashgari中的Bert+BiLSTM+CRF</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1d6689851622">五分钟搭建一个基于BERT的NER模型</a></li>
<li><a target="_blank" rel="noopener" href="https://kashgari-zh.bmio.net/tutorial/text-labeling/">kashgari-zh.bmio.net</a></li>
<li><a target="_blank" rel="noopener" href="https://shfshf.github.io/2019/12/26/Kashgari/">Kashgari概述</a></li>
</ul>
<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><pre class=" language-bash"><code class="language-bash">conda create --envs myTestNER python<span class="token operator">==</span>3.6
pip insall tensorflow<span class="token operator">==</span>1.14.0
pip <span class="token function">install</span> kashgari<span class="token operator">==</span>1.1.5
</code></pre>
<h3 id="下载模型"><a href="#下载模型" class="headerlink" title="下载模型"></a>下载模型</h3><p><a target="_blank" rel="noopener" href="https://github.com/ymcui/Chinese-BERT-wwm/">中文模型</a></p>
<p><img src="https://github.com/ChangzeYan/ChangzeYan.github.io/raw/hexo/source/pic/Chinese-BERT-wwm.png" alt="中文模型下载"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/google-research/bert">英文模型</a></p>
<h3 id="数据格式"><a href="#数据格式" class="headerlink" title="数据格式"></a>数据格式</h3><p>训练集、测试集、验证集的格式均为：</p>
<pre><code>我 O
们 O
变 O
而 O
以 O
书 O
会 O
友 O
， O
把 O
欧 B-LOC
美 B-LOC
流 O
行 O
的 O
食 O
品 O
类 O
图 O
谱 O
、 O
画 O
册 O
</code></pre>
<h3 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Tuple<span class="token punctuation">,</span> List

<span class="token comment" spellcheck="true"># 定义一个读取数据的类</span>
<span class="token keyword">class</span> <span class="token class-name">DataReader</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">read_file</span><span class="token punctuation">(</span>file_path<span class="token punctuation">:</span> str<span class="token punctuation">,</span>
                  text_index<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
                  label_index<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Tuple<span class="token punctuation">[</span>List<span class="token punctuation">[</span>List<span class="token punctuation">[</span>str<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span>str<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        根据文件路径读取训练数据、测试数据以及验证数据的text和label
        """</span>
        x_data<span class="token punctuation">,</span> y_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            lines <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 以splitlines的方式获取数据</span>
            x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
                rows <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 以空格进行切分</span>
                <span class="token keyword">if</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
                    x_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
                    y_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
                    x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                    y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>rows<span class="token punctuation">[</span>text_index<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>rows<span class="token punctuation">[</span>label_index<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> x_data<span class="token punctuation">,</span> y_data
</code></pre>
<h3 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> kashgari
<span class="token keyword">from</span> kashgari <span class="token keyword">import</span> utils
<span class="token keyword">from</span> kashgari<span class="token punctuation">.</span>embeddings <span class="token keyword">import</span> BERTEmbedding<span class="token punctuation">,</span> BERTEmbeddingV2
<span class="token keyword">from</span> kashgari<span class="token punctuation">.</span>tasks<span class="token punctuation">.</span>labeling <span class="token keyword">import</span> BiLSTM_CRF_Model
<span class="token keyword">from</span> data_load <span class="token keyword">import</span> DataReader

kashgari<span class="token punctuation">.</span>config<span class="token punctuation">.</span>use_cudnn_cell <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token comment" spellcheck="true"># 加载训练数据、验证数据以及测试数据</span>

train_x<span class="token punctuation">,</span> train_y <span class="token operator">=</span> DataReader<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">'../data/train.txt'</span><span class="token punctuation">)</span>
test_x<span class="token punctuation">,</span> test_y <span class="token operator">=</span> DataReader<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">'../data/test.txt'</span><span class="token punctuation">)</span>
valid_x<span class="token punctuation">,</span> valid_y <span class="token operator">=</span> DataReader<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">'../data/new_val.txt'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train data count: &amp;#123;len(train_x)&amp;#125;"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"validate data count: &amp;#123;len(valid_x)&amp;#125;"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"test data count: &amp;#123;len(test_x)&amp;#125;"</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 利用kashgari创建Bert Embedding</span>

bert_embed <span class="token operator">=</span> BERTEmbedding<span class="token punctuation">(</span><span class="token string">'chinese_wwm_ext_L-12_H-768_A-12'</span><span class="token punctuation">,</span>
                           task<span class="token operator">=</span>kashgari<span class="token punctuation">.</span>LABELING<span class="token punctuation">,</span>
                           sequence_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 调用BiLSTM_CRF_Model模型并进行训练</span>

model <span class="token operator">=</span> BiLSTM_CRF_Model<span class="token punctuation">(</span>bert_embed<span class="token punctuation">)</span>

model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token operator">=</span>train_x<span class="token punctuation">,</span> y_train<span class="token operator">=</span>train_y<span class="token punctuation">,</span>
          x_validate<span class="token operator">=</span>valid_x<span class="token punctuation">,</span> y_validate<span class="token operator">=</span>valid_y<span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'./model/NER.h5'</span><span class="token punctuation">)</span>

model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>test_x<span class="token punctuation">,</span> test_y<span class="token punctuation">)</span>

model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'小'</span><span class="token punctuation">,</span> <span class="token string">'明'</span><span class="token punctuation">,</span> <span class="token string">'在'</span><span class="token punctuation">,</span> <span class="token string">'商'</span><span class="token punctuation">,</span> <span class="token string">'务'</span><span class="token punctuation">,</span> <span class="token string">'部'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="使用自带的人民日报数据"><a href="#使用自带的人民日报数据" class="headerlink" title="使用自带的人民日报数据"></a>使用自带的人民日报数据</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> jieba
<span class="token keyword">from</span> kashgari<span class="token punctuation">.</span>tasks<span class="token punctuation">.</span>seq_labeling <span class="token keyword">import</span> BLSTMCRFModel
<span class="token keyword">from</span> kashgari<span class="token punctuation">.</span>corpus <span class="token keyword">import</span> ChinaPeoplesDailyNerCorpus
<span class="token keyword">from</span> kashgari<span class="token punctuation">.</span>embeddings <span class="token keyword">import</span> BERTEmbedding
embedding <span class="token operator">=</span> BERTEmbedding<span class="token punctuation">(</span><span class="token string">'/home/eee/sentence-alignment-classification-model/model/multi_cased_L-12_H-768_A-12'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
 
train_x<span class="token punctuation">,</span> train_y <span class="token operator">=</span> ChinaPeoplesDailyNerCorpus<span class="token punctuation">.</span>get_sequence_tagging_data<span class="token punctuation">(</span><span class="token string">'train'</span><span class="token punctuation">)</span>
validate_x<span class="token punctuation">,</span> validate_y <span class="token operator">=</span> ChinaPeoplesDailyNerCorpus<span class="token punctuation">.</span>get_sequence_tagging_data<span class="token punctuation">(</span><span class="token string">'validate'</span><span class="token punctuation">)</span>
test_x<span class="token punctuation">,</span> test_y  <span class="token operator">=</span> ChinaPeoplesDailyNerCorpus<span class="token punctuation">.</span>get_sequence_tagging_data<span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">)</span>
 
model <span class="token operator">=</span> BLSTMCRFModel<span class="token punctuation">(</span>embedding<span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_x<span class="token punctuation">,</span>
          train_y<span class="token punctuation">,</span>
          validate_y<span class="token operator">=</span>validate_y<span class="token punctuation">,</span>
          validate_x<span class="token operator">=</span>validate_x<span class="token punctuation">,</span>
          epochs<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>
          batch_size<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
model<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'./model'</span><span class="token punctuation">)</span>
 
new_model <span class="token operator">=</span> BLSTMCRFModel<span class="token punctuation">.</span>load_model<span class="token punctuation">(</span><span class="token string">'./model'</span><span class="token punctuation">)</span>
 
<span class="token comment" spellcheck="true"># EXAMPLE 1</span>
news <span class="token operator">=</span> <span class="token string">"「DeepMind 击败人类职业玩家的方式与他们声称的 AI 使命，以及所声称的『正确』方式完全相反。」"</span>
x <span class="token operator">=</span> list<span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>news<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> x
<span class="token punctuation">[</span><span class="token string">'「'</span><span class="token punctuation">,</span> <span class="token string">'DeepMind'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'击败'</span><span class="token punctuation">,</span> <span class="token string">'人类'</span><span class="token punctuation">,</span> <span class="token string">'职业'</span><span class="token punctuation">,</span> <span class="token string">'玩家'</span><span class="token punctuation">,</span> <span class="token string">'的'</span><span class="token punctuation">,</span> <span class="token string">'方式'</span><span class="token punctuation">,</span> <span class="token string">'与'</span><span class="token punctuation">,</span> <span class="token string">'他们'</span><span class="token punctuation">,</span> <span class="token string">'声称'</span><span class="token punctuation">,</span> <span class="token string">'的'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'AI'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'使命'</span><span class="token punctuation">,</span> <span class="token string">'，'</span><span class="token punctuation">,</span> <span class="token string">'以及'</span><span class="token punctuation">,</span> <span class="token string">'所'</span><span class="token punctuation">,</span> <span class="token string">'声称'</span><span class="token punctuation">,</span> <span class="token string">'的'</span><span class="token punctuation">,</span> <span class="token string">'『'</span><span class="token punctuation">,</span> <span class="token string">'正确'</span><span class="token punctuation">,</span> <span class="token string">'』'</span><span class="token punctuation">,</span> <span class="token string">'方式'</span><span class="token punctuation">,</span> <span class="token string">'完全'</span><span class="token punctuation">,</span> <span class="token string">'相反'</span><span class="token punctuation">,</span> <span class="token string">'。'</span><span class="token punctuation">,</span> <span class="token string">'」'</span><span class="token punctuation">]</span>
<span class="token operator">>></span><span class="token operator">></span> new_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>                                                                                                     
<span class="token punctuation">[</span><span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">]</span>
 
<span class="token comment" spellcheck="true"># EXAMPLE 2</span>
news <span class="token operator">=</span> <span class="token string">"陈志衍是有个非常好的男孩子，他住在香港的九龙塘区，他今年二十三号生日。"</span>
x <span class="token operator">=</span> list<span class="token punctuation">(</span>jieba<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>news<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> x
<span class="token punctuation">[</span><span class="token string">'陈志衍'</span><span class="token punctuation">,</span> <span class="token string">'是'</span><span class="token punctuation">,</span> <span class="token string">'有'</span><span class="token punctuation">,</span> <span class="token string">'个'</span><span class="token punctuation">,</span> <span class="token string">'非常'</span><span class="token punctuation">,</span> <span class="token string">'好'</span><span class="token punctuation">,</span> <span class="token string">'的'</span><span class="token punctuation">,</span> <span class="token string">'男孩子'</span><span class="token punctuation">,</span> <span class="token string">'，'</span><span class="token punctuation">,</span> <span class="token string">'他'</span><span class="token punctuation">,</span> <span class="token string">'住'</span><span class="token punctuation">,</span> <span class="token string">'在'</span><span class="token punctuation">,</span> <span class="token string">'香港'</span><span class="token punctuation">,</span> <span class="token string">'的'</span><span class="token punctuation">,</span> <span class="token string">'吉林'</span><span class="token punctuation">,</span> <span class="token string">'区'</span><span class="token punctuation">,</span> <span class="token string">'，'</span><span class="token punctuation">,</span> <span class="token string">'他'</span><span class="token punctuation">,</span> <span class="token string">'今年'</span><span class="token punctuation">,</span> <span class="token string">'二十三'</span><span class="token punctuation">,</span> <span class="token string">'号'</span><span class="token punctuation">,</span> <span class="token string">'生日'</span><span class="token punctuation">,</span> <span class="token string">'。'</span><span class="token punctuation">]</span>
<span class="token operator">>></span><span class="token operator">></span> new_model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">]</span>
</code></pre>
<h3 id="自带数据集"><a href="#自带数据集" class="headerlink" title="自带数据集"></a>自带数据集</h3><pre><code>加载内置数据集
中文数据集
from kashgari.corpus import ChineseDailyNerCorpus

train_x, train_y = ChineseDailyNerCorpus.load_data(&#39;train&#39;)
valid_x, valid_y = ChineseDailyNerCorpus.load_data(&#39;valid&#39;)
test_x, test_y = ChineseDailyNerCorpus.load_data(&#39;test&#39;)

英文数据集
from kashgari.corpus import CONLL2003ENCorpus

train_x, train_y = CONLL2003ENCorpus.load_data(&#39;train&#39;)
valid_x, valid_y = CONLL2003ENCorpus.load_data(&#39;valid&#39;)
test_x, test_y = CONLL2003ENCorpus.load_data(&#39;test&#39;)

# 也可以使用自己的数据集
train_x = [[&#39;Hello&#39;, &#39;world&#39;], [&#39;Hello&#39;, &#39;Kashgari&#39;], [&#39;I&#39;, &#39;love&#39;, &#39;Beijing&#39;]]
train_y = [[&#39;O&#39;, &#39;O&#39;], [&#39;O&#39;, &#39;B-PER&#39;], [&#39;O&#39;, &#39;B-LOC&#39;]]

valid_x, valid_y = train_x, train_y
test_x, test_x = train_x, train_y
</code></pre>
<h2 id="stanza"><a href="#stanza" class="headerlink" title="stanza"></a><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/HcX8b84YazwVI-usWsCUew">stanza</a></h2><h2 id="LTP"><a href="#LTP" class="headerlink" title="LTP"></a>LTP</h2><p>参考：<a target="_blank" rel="noopener" href="https://ltp.readthedocs.io/zh_CN/latest/index.html">LTP4 文档</a></p>
<h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><pre><code>pip install ltp
</code></pre>
<h3 id="加载模型"><a href="#加载模型" class="headerlink" title="加载模型"></a>加载模型</h3><pre><code>from ltp import LTP
ltp = LTP() # 默认加载 Small 模型
# ltp = LTP(path = &quot;base|small|tiny&quot;)
# ltp = LTP(path = &quot;tiny.tgz|tiny-tgz-extracted&quot;) # 其中 tiny-tgz-extracted 是 tiny.tgz 解压出来的文件夹
</code></pre>
<h3 id="命名实体识别"><a href="#命名实体识别" class="headerlink" title="命名实体识别"></a>命名实体识别</h3><pre><code>from ltp import LTP

ltp = LTP()

seg, hidden = ltp.seg([&quot;他叫汤姆去拿外衣。&quot;])
ner = ltp.ner(hidden)
# [[&#39;他&#39;, &#39;叫&#39;, &#39;汤姆&#39;, &#39;去&#39;, &#39;拿&#39;, &#39;外衣&#39;, &#39;。&#39;]]
# [[(&#39;Nh&#39;, 2, 2)]]

tag, start, end = ner[0][0]
print(tag,&quot;:&quot;, &quot;&quot;.join(seg[0][start:end + 1]))
# Nh : 汤姆
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/28/python/python-yu-fa/python-str/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/28/python/python-yu-fa/python-str/" class="post-title-link" itemprop="url">Python-str</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-28 16:05:26" itemprop="dateCreated datePublished" datetime="2021-01-28T16:05:26+08:00">2021-01-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-26 17:19:06" itemprop="dateModified" datetime="2021-09-26T17:19:06+08:00">2021-09-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h1><p>多个字符串拼接可以用join:</p>
<pre class=" language-python"><code class="language-python">str_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'world'</span><span class="token punctuation">]</span>
str_join1 <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>str_list<span class="token punctuation">)</span>
str_join2 <span class="token operator">=</span> <span class="token string">'-'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>str_list<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str_join1<span class="token punctuation">)</span> <span class="token operator">>></span><span class="token operator">></span>Hello world
<span class="token keyword">print</span><span class="token punctuation">(</span>str_join2<span class="token punctuation">)</span> <span class="token operator">>></span><span class="token operator">></span>Hello<span class="token operator">-</span>world
</code></pre>
<p>加号拼接:</p>
<pre class=" language-python"><code class="language-python">str_1 <span class="token operator">=</span> <span class="token string">'Hello world！ '</span>
str_2 <span class="token operator">=</span> <span class="token string">'My name is Python猫.'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str_1 <span class="token operator">+</span> str_2<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span>Hello world！ My name <span class="token keyword">is</span> Python猫<span class="token punctuation">.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str_1<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span>Hello world！
</code></pre>
<p>字符串增长：</p>
<pre><code>str += &#39;s&#39;
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/28/linux/mongo/mongo-grammar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/28/linux/mongo/mongo-grammar/" class="post-title-link" itemprop="url">Mongo语法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-28 15:54:30" itemprop="dateCreated datePublished" datetime="2021-01-28T15:54:30+08:00">2021-01-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-17 09:23:42" itemprop="dateModified" datetime="2021-06-17T09:23:42+08:00">2021-06-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Liunx/" itemprop="url" rel="index"><span itemprop="name">Liunx</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h1><h2 id="查询所有"><a href="#查询所有" class="headerlink" title="查询所有"></a>查询所有</h2><pre class=" language-bash"><code class="language-bash">db.collection.find<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="获取数据条数"><a href="#获取数据条数" class="headerlink" title="获取数据条数"></a>获取数据条数</h2><pre class=" language-bash"><code class="language-bash">db.collection.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="范围查询"><a href="#范围查询" class="headerlink" title="范围查询"></a>范围查询</h2><pre class=" language-bash"><code class="language-bash">查询age<span class="token operator">></span>22的记录
db.userInfo.find<span class="token punctuation">((</span>age:<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;$gt:22&amp;#125;&amp;#125;);</span>
查询age<span class="token operator">&lt;</span>22的记录
db.userInfo.find<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;age:&amp;#123;$lt:22&amp;#125;&amp;#125;);</span>
查询age<span class="token operator">>=</span>25的记录
db.userInfo.find<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;age:&amp;#123;$gte:25&amp;#125;&amp;#125;);</span>
查询age<span class="token operator">&lt;=</span>25的记录
db.userInfo.find<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;age:&amp;#123;$lte:25&amp;#125;&amp;#125;);</span>
查询age<span class="token operator">></span>23并且age<span class="token operator">&lt;=</span>26
db.userInfo.find<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;age:&amp;#123;gte:23,$lte:26&amp;#125;&amp;#125;);</span>
</code></pre>
<h2 id="and"><a href="#and" class="headerlink" title="and"></a>and</h2><p>查询student 集合中名字为zs且id为02的项:</p>
<pre class=" language-bash"><code class="language-bash">db.getCollection<span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">)</span>.find<span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;"name":"zs","id":"02"&amp;#125;)</span>
</code></pre>
<h2 id="查询集合中指定字段的所有不同值"><a href="#查询集合中指定字段的所有不同值" class="headerlink" title="查询集合中指定字段的所有不同值"></a>查询集合中指定字段的所有不同值</h2><pre><code>db.目标集合.distinct(&quot;指定字段&quot;)
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/27/linux/ming-ling/install-python3-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/27/linux/ming-ling/install-python3-6/" class="post-title-link" itemprop="url">Linux安装Python3.6</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-01-27 19:26:20 / 修改时间：19:50:44" itemprop="dateCreated datePublished" datetime="2021-01-27T19:26:20+08:00">2021-01-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参考: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/yangzhaon/p/11203395.html">Centos7安装python3.6.5
</a></p>
<p>安装python3.6.5,原来的python2.7并存</p>
<h1 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h1><pre class=" language-bash"><code class="language-bash">yum <span class="token function">install</span> openssl-devel bzip2-devel expat-devel gdbm-devel readline-devel sqlite-devel <span class="token function">wget</span>
</code></pre>
<p>下载安装包:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">wget</span> https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz
</code></pre>
<p>解压文件:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">tar</span> -zxvf Python-3.6.5.tgz
</code></pre>
<p>进入 解压后的目录,指定编译后文件的目录:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">cd</span> Python-3.6.5.tgz

./configure --prefix<span class="token operator">=</span>/usr/local/python3
</code></pre>
<p>编译:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre>
<p>如果出现zipimport.ZipImportError: can’t decompress data; zlib not avaliable,则安装:</p>
<pre class=" language-bash"><code class="language-bash">yum <span class="token function">install</span> -y zlib*
</code></pre>
<p>然后重新执行make</p>
<h1 id="设置软链"><a href="#设置软链" class="headerlink" title="设置软链"></a>设置软链</h1><p>查看 /usr/bin下是否有pip3和python3,如果没有设置下面的软链:</p>
<pre class=" language-bash"><code class="language-bash"><span class="token function">ln</span> -s /usr/local/python3/bin/python3 /usr/bin/python3
<span class="token function">ln</span> -s /usr/local/python3/bin/pip3 /usr/bin/pip3
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/27/linux/ming-ling/update-centos-core/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/27/linux/ming-ling/update-centos-core/" class="post-title-link" itemprop="url">更新Centos内核</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-01-27 18:51:13 / 修改时间：19:07:20" itemprop="dateCreated datePublished" datetime="2021-01-27T18:51:13+08:00">2021-01-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参考: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xzkzzz/p/9627658.html">Centos7 升级内核版本</a></p>
<h1 id="查看当前内核版本"><a href="#查看当前内核版本" class="headerlink" title="查看当前内核版本"></a>查看当前内核版本</h1><pre class=" language-bash"><code class="language-bash">内核版本
$ <span class="token function">uname</span> -r
3.10.0-514.el7.x86_64

$ <span class="token function">uname</span> -a
Linux k8s-master 3.10.0-514.el7.x86_64 <span class="token comment" spellcheck="true">#1 SMP Tue Nov 22 16:42:41 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span>

centos版本：
$ <span class="token function">cat</span> /etc/redhat-release 
CentOS Linux release 7.3.1611 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span> 
</code></pre>
<h1 id="升级内核"><a href="#升级内核" class="headerlink" title="升级内核"></a>升级内核</h1><h2 id="更新yum源仓库"><a href="#更新yum源仓库" class="headerlink" title="更新yum源仓库"></a>更新yum源仓库</h2><pre class=" language-bash"><code class="language-bash">$ yum -y update
</code></pre>
<h2 id="启用-ELRepo-仓库"><a href="#启用-ELRepo-仓库" class="headerlink" title="启用 ELRepo 仓库"></a>启用 ELRepo 仓库</h2><p>ELRepo 仓库是基于社区的用于企业级 Linux 仓库，提供对 RedHat Enterprise (RHEL) 和 其他基于 RHEL的 Linux 发行版（CentOS、Scientific、Fedora 等）的支持。<br>ELRepo 聚焦于和硬件相关的软件包，包括文件系统驱动、显卡驱动、网络驱动、声卡驱动和摄像头驱动等。</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#导入ELRepo仓库的公共密钥</span>
rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
<span class="token comment" spellcheck="true">#安装ELRepo仓库的yum源</span>
rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
</code></pre>
<h2 id="查看可用的系统内核包"><a href="#查看可用的系统内核包" class="headerlink" title="查看可用的系统内核包"></a>查看可用的系统内核包</h2><pre class=" language-bash"><code class="language-bash">yum --disablerepo<span class="token operator">=</span><span class="token string">"*"</span> --enablerepo<span class="token operator">=</span><span class="token string">"elrepo-kernel"</span> list available
</code></pre>
<h2 id="安装最新版本内核"><a href="#安装最新版本内核" class="headerlink" title="安装最新版本内核"></a>安装最新版本内核</h2><pre class=" language-bash"><code class="language-bash">yum --enablerepo<span class="token operator">=</span>elrepo-kernel <span class="token function">install</span> kernel-ml
</code></pre>
<p>–enablerepo 选项开启 CentOS 系统上的指定仓库。默认开启的是 elrepo，这里用 elrepo-kernel 替换。</p>
<h1 id="设置-grub2"><a href="#设置-grub2" class="headerlink" title="设置 grub2"></a>设置 grub2</h1><p>内核安装好后，需要设置为默认启动选项并重启后才会生效</p>
<h2 id="查看系统上的所有可用内核"><a href="#查看系统上的所有可用内核" class="headerlink" title="查看系统上的所有可用内核"></a>查看系统上的所有可用内核</h2><pre class=" language-bash"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">awk</span> -F\<span class="token string">' '</span><span class="token variable">$1</span><span class="token operator">==</span><span class="token string">"menuentry "</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;print i++ " : " $2&amp;#125;' /etc/grub2.cfg</span>
0 <span class="token keyword">:</span> CentOS Linux <span class="token punctuation">(</span>4.18.7-1.el7.elrepo.x86_64<span class="token punctuation">)</span> 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
1 <span class="token keyword">:</span> CentOS Linux <span class="token punctuation">(</span>3.10.0-862.11.6.el7.x86_64<span class="token punctuation">)</span> 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
2 <span class="token keyword">:</span> CentOS Linux <span class="token punctuation">(</span>3.10.0-514.el7.x86_64<span class="token punctuation">)</span> 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
3 <span class="token keyword">:</span> CentOS Linux <span class="token punctuation">(</span>0-rescue-063ec330caa04d4baae54c6902c62e54<span class="token punctuation">)</span> 7 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
</code></pre>
<h2 id="设置新的内核为grub2的默认版本"><a href="#设置新的内核为grub2的默认版本" class="headerlink" title="设置新的内核为grub2的默认版本"></a>设置新的内核为grub2的默认版本</h2><p>服务器上存在4 个内核，我们要使用 4.18 这个版本，可以通过 grub2-set-default 0 命令或编辑 /etc/default/grub 文件来设置</p>
<h3 id="方法1、通过-grub2-set-default-0-命令设置"><a href="#方法1、通过-grub2-set-default-0-命令设置" class="headerlink" title="方法1、通过 grub2-set-default 0 命令设置"></a>方法1、通过 grub2-set-default 0 命令设置</h3><p>其中 0 是上面查询出来的可用内核编号</p>
<pre class=" language-bash"><code class="language-bash">grub2-set-default 0
</code></pre>
<h3 id="方法2、编辑-etc-default-grub-文件"><a href="#方法2、编辑-etc-default-grub-文件" class="headerlink" title="方法2、编辑 /etc/default/grub 文件"></a>方法2、编辑 /etc/default/grub 文件</h3><p>设置 GRUB_DEFAULT=0，通过上面查询显示的编号为 0 的内核作为默认内核：</p>
<pre class=" language-bash"><code class="language-bash">$ vim /etc/default/grub
GRUB_TIMEOUT<span class="token operator">=</span>5
GRUB_DISTRIBUTOR<span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">sed</span> 's, release .*$,,g' /etc/system-release<span class="token variable">)</span></span>"</span>
GRUB_DEFAULT<span class="token operator">=</span>0
GRUB_DISABLE_SUBMENU<span class="token operator">=</span>true
GRUB_TERMINAL_OUTPUT<span class="token operator">=</span><span class="token string">"console"</span>
GRUB_CMDLINE_LINUX<span class="token operator">=</span><span class="token string">"crashkernel=auto rd.lvm.lv=cl/root rhgb quiet"</span>
GRUB_DISABLE_RECOVERY<span class="token operator">=</span><span class="token string">"true"</span>
</code></pre>
<p>生成 grub 配置文件并重启</p>
<pre class=" language-bash"><code class="language-bash">grub2-mkconfig -o /boot/grub2/grub.cfg


<span class="token function">reboot</span>
</code></pre>
<h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><pre class=" language-bash"><code class="language-bash">$ <span class="token function">uname</span> -r
4.18.7-1.el7.elrepo.x86_64
</code></pre>
<h1 id="删除旧内核（可选）"><a href="#删除旧内核（可选）" class="headerlink" title="删除旧内核（可选）"></a>删除旧内核（可选）</h1><p>查看系统中全部的内核：</p>
<pre class=" language-bash"><code class="language-bash">$ rpm -qa <span class="token operator">|</span> <span class="token function">grep</span> kernel
kernel-3.10.0-514.el7.x86_64
kernel-ml-4.18.7-1.el7.elrepo.x86_64
kernel-tools-libs-3.10.0-862.11.6.el7.x86_64
kernel-tools-3.10.0-862.11.6.el7.x86_64
kernel-3.10.0-862.11.6.el7.x86_64
</code></pre>
<h2 id="方法1、yum-remove-删除旧内核的-RPM-包"><a href="#方法1、yum-remove-删除旧内核的-RPM-包" class="headerlink" title="方法1、yum remove 删除旧内核的 RPM 包"></a>方法1、yum remove 删除旧内核的 RPM 包</h2><pre class=" language-bash"><code class="language-bash">$ yum remove kernel-3.10.0-514.el7.x86_64 \
kernel-tools-libs-3.10.0-862.11.6.el7.x86_64 \
kernel-tools-3.10.0-862.11.6.el7.x86_64 \
kernel-3.10.0-862.11.6.el7.x86_64
</code></pre>
<h2 id="方法2、yum-utils-工具"><a href="#方法2、yum-utils-工具" class="headerlink" title="方法2、yum-utils 工具"></a>方法2、yum-utils 工具</h2><p>如果安装的内核不多于 3 个，yum-utils 工具不会删除任何一个。只有在安装的内核大于 3 个时，才会自动删除旧内核。<br>安装yum-utils</p>
<pre class=" language-bash"><code class="language-bash">$ yum <span class="token function">install</span> yum-utils
</code></pre>
<p>删除旧版本　</p>
<pre class=" language-bash"><code class="language-bash">package-cleanup --oldkernels
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/26/python/python-yu-fa/python-heap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/26/python/python-yu-fa/python-heap/" class="post-title-link" itemprop="url">Python-堆</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-26 12:05:51" itemprop="dateCreated datePublished" datetime="2021-01-26T12:05:51+08:00">2021-01-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-01 18:39:51" itemprop="dateModified" datetime="2021-02-01T18:39:51+08:00">2021-02-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> heapq <span class="token keyword">import</span> <span class="token operator">*</span> 
<span class="token comment" spellcheck="true"># 建立堆</span>
heap<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment" spellcheck="true"># 将x压入堆中</span>
heappush<span class="token punctuation">(</span>heap<span class="token punctuation">,</span> x<span class="token punctuation">)</span>    
<span class="token comment" spellcheck="true"># 从堆中弹出最小的元素              </span>
heappop<span class="token punctuation">(</span>heap<span class="token punctuation">)</span>   

<span class="token comment" spellcheck="true"># 让列表具备堆特征，函数heapify通过执行尽可能少的移位操作将列表变成合法的堆（即具备堆特征）。如果你的堆并不是使用heappush创建的，应在使用heappush和heappop之前使用这个函数。</span>
heapify<span class="token punctuation">(</span>heap<span class="token punctuation">)</span> 
<span class="token comment" spellcheck="true"># 弹出最小的元素，并将x压入堆中</span>
heapreplace<span class="token punctuation">(</span>heap<span class="token punctuation">,</span> x<span class="token punctuation">)</span>        

<span class="token comment" spellcheck="true"># 返回iter中n个最大的元素</span>
nlargest<span class="token punctuation">(</span>n<span class="token punctuation">,</span> iter<span class="token punctuation">)</span>                           
<span class="token comment" spellcheck="true"># 返回iter中n个最小的元素            </span>
nsmallest<span class="token punctuation">(</span>n<span class="token punctuation">,</span> iter<span class="token punctuation">)</span>                                   
</code></pre>
<h1 id="自定义排序"><a href="#自定义排序" class="headerlink" title="自定义排序"></a>自定义排序</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Document</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> _id<span class="token punctuation">,</span> con<span class="token punctuation">,</span> goal<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>id <span class="token operator">=</span> str<span class="token punctuation">(</span>_id<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>content <span class="token operator">=</span> con
        self<span class="token punctuation">.</span>goal <span class="token operator">=</span> goal

    <span class="token comment" spellcheck="true"># 按照goal，从小到大排序</span>
    <span class="token keyword">def</span> <span class="token function">__lt__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>goal <span class="token operator">&lt;</span> other<span class="token punctuation">.</span>goal<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>

d1<span class="token operator">=</span>Document<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">"fda"</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span>
d2<span class="token operator">=</span>Document<span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span><span class="token string">"fda"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
d3<span class="token operator">=</span>Document<span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span><span class="token string">"fda"</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">)</span>

li<span class="token operator">=</span><span class="token punctuation">[</span>d1<span class="token punctuation">,</span>d2<span class="token punctuation">,</span>d3<span class="token punctuation">]</span>
li<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/07/linux/kafka/java-connectkafka/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/07/linux/kafka/java-connectkafka/" class="post-title-link" itemprop="url">Java-ConnectKafka</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-01-07 09:58:00 / 修改时间：09:59:36" itemprop="dateCreated datePublished" datetime="2021-01-07T09:58:00+08:00">2021-01-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kafka/" itemprop="url" rel="index"><span itemprop="name">Kafka</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="从头开始消费"><a href="#从头开始消费" class="headerlink" title="从头开始消费"></a>从头开始消费</h2><p>消费者要从头开始消费某个topic的全量数据，需要满足2个条件（spring-kafka）：</p>
<ul>
<li>使用一个全新的”group.id”（就是之前没有被任何消费者使用过）;</li>
<li>指定”auto.offset.reset”参数的值为earliest；</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://changzeyan.github.io/2021/01/06/write/latex/latex-table/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ChangzeYan">
      <meta itemprop="description" content="天空中没有留下翅膀的痕迹，但我已飞过">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YCZ">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/06/write/latex/latex-table/" class="post-title-link" itemprop="url">Latex-table</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-06 11:37:01" itemprop="dateCreated datePublished" datetime="2021-01-06T11:37:01+08:00">2021-01-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-23 21:10:26" itemprop="dateModified" datetime="2021-05-23T21:10:26+08:00">2021-05-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Latex/" itemprop="url" rel="index"><span itemprop="name">Latex</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="三线表"><a href="#三线表" class="headerlink" title="三线表"></a>三线表</h2><p>\vspace{-0.5em}用于设置与表标题之间的距离</p>
<pre><code>\begin&#123;table&#125;[!ht]
    \bicaption&#123;八种DNA编码规则&#125;&#123;Eight kinds of DNA coding rules.&#125;
    \label&#123;tab:atcg&#125;
    \vspace&#123;-0.5em&#125;\centering\wuhao
    \begin&#123;tabular&#125;&#123;cccc&#125;
        \toprule
        词 &amp; 经济 &amp; 政治 &amp; 体育 \\
        \midrule
        “冠军” &amp; -6.9077 &amp; -6.9077 &amp; 0.6931\\
        \bottomrule
    \end&#123;tabular&#125;
\end&#123;table&#125;
</code></pre>
<h2 id="设置表格列宽"><a href="#设置表格列宽" class="headerlink" title="设置表格列宽"></a>设置表格列宽</h2><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/sptoor/article/details/21493777">Latex设定表格列宽</a></p>
<p>固定列宽可以使用 array 宏包的 p{2cm} 系列命令，如果需要指定水平对齐方式，可以使用下面的形式 &gt;{\centering}p{2cm} 实现，但如果使用这种方式，缺省情况下不能使用 \ 换行，需要使用\tabularnewline 代替。为了仍然使用 \ 换行，需要在导言区加上下面的代码：</p>
<pre><code>\usepackage&#123;array&#125;
\newcommand&#123;\PreserveBackslash&#125;[1]&#123;\let\temp=\\#1\let\\=\temp&#125;
\newcolumntype&#123;C&#125;[1]&#123;&gt;&#123;\PreserveBackslash\centering&#125;p&#123;#1&#125;&#125;
\newcolumntype&#123;R&#125;[1]&#123;&gt;&#123;\PreserveBackslash\raggedleft&#125;p&#123;#1&#125;&#125;
\newcolumntype&#123;L&#125;[1]&#123;&gt;&#123;\PreserveBackslash\raggedright&#125;p&#123;#1&#125;&#125;
</code></pre>
<p>使用 C{3cm} 命令即可指定该列宽度为 3cm，并且文字居中对齐，左对齐和右对齐命令分别是 L{2cm} 和R{2cm}。</p>
<pre><code>\begin&#123;table&#125;[htbp]
  \centering\caption&#123;\label&#123;tab:test&#125;2000 和~2004 年中国制造业产品的出口份额&#125;
  \begin&#123;tabular&#125;&#123;L&#123;2cm&#125;C&#123;2cm&#125;R&#123;2cm&#125;&#125;
    \toprule
    &amp; 2000 &amp; 2004 \\
    \midrule
    钢铁 &amp; 3.1 &amp; 5.2 \\
    化学制品 &amp; 2.1 &amp; 2.7 \\
    办公设备及电信设备 &amp; 4.5 &amp; 15.2 \\
    汽车产品 &amp; 0.3 &amp; 0.7 \\
    纺织品 &amp; 10.4 &amp; 17.2 \\
    服装 &amp; 18.3 &amp; 24\\
    \bottomrule
  \end&#123;tabular&#125;
\end&#123;table&#125;
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ChangzeYan</p>
  <div class="site-description" itemprop="description">天空中没有留下翅膀的痕迹，但我已飞过</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ChangzeYan</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
